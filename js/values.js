// Parameters
const OFFSET = 200; // Offset for projection on both X- and Z-axis
const STARTING_LINE_SIZE = 120; // Starting line projection size
const DRAG_MIN_DISTANCE = 100; // Distance from track when dragging cursor is effective
const CURSORS_INIT_GAP = 840; // Gap between cursors at initialization

// http://japan-mk.blog.jp/mk8dx/note4/prob.html
// Format : up to X distance : shock probability
const SHOCK_DISTANCES = {
    4075: { prob: 0.0, color: 'red' }, 
    4700: { prob: 1.5, color: 'blue' },
    5750: { prob: 3.5, color: 'darkgreen' },
    6270: { prob: 1.8, color: 'blue' },
    7135: { prob: 3.7, color: 'darkgreen' },
    8700: { prob: 2.1, color: 'blue' },
    13001: { prob: 3.7, color: 'darkgreen' },
    999999: { prob: 9.1, color: 'lightgreen' }
};

// Extractions of track points (from BYAML files, using Steer Assist paths)
const RIVERSIDE_PT = [{ x: -602.1974, y: 102.287, z: -355.8759 },{ x: -595.3069, y: 102.2617, z: -523.3562 },{ x: -588.8146, y: 102.2344, z: -681.1578 },{ x: -602.1974, y: 102.1887, z: -783.9346 },{ x: -608.5293, y: 102.8883, z: -1106.57 },{ x: -566.0713, y: 106.886, z: -1362.012 },{ x: -380.2195, y: 113.4365, z: -1544.568 },{ x: -127.989, y: 110.3023, z: -1605.591 },{ x: 121.3349, y: 106.7692, z: -1545.964 },{ x: 336.7902, y: 106.3892, z: -1385.079 },{ x: 553.291, y: 107.3484, z: -1268.925 },{ x: 816.7278, y: 103.5871, z: -1256.67 },{ x: 1053.974, y: 102.4935, z: -1329.0 },{ x: 1326.378, y: 111.1461, z: -1413.902 },{ x: 1582.975, y: 119.7679, z: -1402.786 },{ x: 1822.315, y: 124.6434, z: -1312.154 },{ x: 1991.335, y: 127.7911, z: -1150.523 },{ x: 2012.397, y: 125.9828, z: -936.8051 },{ x: 1857.812, y: 125.2057, z: -747.3607 },{ x: 1586.333, y: 143.749, z: -610.2764 },{ x: 1207.424, y: 75.91881, z: -450.7655 },{ x: 960.7543, y: 75.12085, z: -352.7678 },{ x: 805.5818, y: 74.39481, z: -288.7627 },{ x: 389.7421, y: 84.69221, z: -75.74362 },{ x: 306.524, y: 94.63943, z: 164.0293 },{ x: 357.4863, y: 88.59413, z: 383.7825 },{ x: 568.7723, y: 81.77747, z: 598.5039 },{ x: 846.8135, y: 74.98548, z: 838.6572 },{ x: 1030.534, y: 74.93359, z: 1018.77 },{ x: 1145.125, y: 74.91394, z: 1106.811 },{ x: 1255.174, y: 74.89503, z: 1152.157 },{ x: 1412.543, y: 75.32908, z: 1169.188 },{ x: 1635.716, y: 77.04791, z: 1165.932 },{ x: 1809.104, y: 80.15552, z: 1178.792 },{ x: 1979.48, y: 84.37671, z: 1210.156 },{ x: 2104.982, y: 96.06047, z: 1304.138 },{ x: 2255.491, y: 97.23364, z: 1598.629 },{ x: 2084.547, y: 98.23534, z: 1882.279 },{ x: 1861.539, y: 90.76467, z: 2031.245 },{ x: 1558.434, y: 78.99174, z: 2131.767 },{ x: 1360.062, y: 80.46955, z: 2152.661 },{ x: 1150.977, y: 85.60938, z: 2087.614 },{ x: 999.324, y: 89.99272, z: 1889.632 },{ x: 873.2413, y: 86.20996, z: 1658.304 },{ x: 749.796, y: 80.13641, z: 1484.537 },{ x: 615.7271, y: 73.91552, z: 1365.84 },{ x: 329.6405, y: 69.30266, z: 1258.417 },{ x: 53.27979, y: 72.75204, z: 1243.697 },{ x: -227.2538, y: 76.34804, z: 1244.323 },{ x: -565.8184, y: 74.30463, z: 1240.385 },{ x: -825.4449, y: 82.20001, z: 1221.522 },{ x: -1058.367, y: 98.31195, z: 1178.423 },{ x: -1314.384, y: 118.3495, z: 1202.871 },{ x: -1519.503, y: 140.3766, z: 1343.348 },{ x: -1639.733, y: 170.6043, z: 1555.698 },{ x: -1655.187, y: 208.8298, z: 1806.282 },{ x: -1555.376, y: 254.3622, z: 2042.168 },{ x: -1334.17, y: 312.0957, z: 2215.503 },{ x: -1069.338, y: 379.2523, z: 2243.193 },{ x: -810.9674, y: 444.296, z: 2105.839 },{ x: -653.7974, y: 483.8934, z: 1929.378 },{ x: -586.2493, y: 501.9691, z: 1695.674 },{ x: -580.7349, y: 504.9804, z: 1441.381 },{ x: -580.694, y: 510.0043, z: 1217.38 },{ x: -600.6896, y: 305.5406, z: 702.0017 },{ x: -602.1974, y: 102.287, z: 373.5132 },{ x: -602.1974, y: 102.287, z: 22.47269 }];
const EXCITEBIKE_PT = [{ x: -463.2128, y: 1000.0, z: 1944.298 },{ x: -461.3065, y: 1000.13, z: 1508.445 },{ x: -461.2909, y: 1000.315, z: 1037.862 },{ x: -461.4852, y: 999.0, z: 648.5826 },{ x: -461.1199, y: 999.0, z: 245.8651 },{ x: -461.12, y: 999.0, z: -123.6973 },{ x: -461.291, y: 999.0, z: -535.9985 },{ x: -461.12, y: 999.0001, z: -937.8354 },{ x: -462.2597, y: 999.0, z: -1351.429 },{ x: -460.9776, y: 999.0, z: -1779.181 },{ x: -461.1199, y: 998.9999, z: -2241.712 },{ x: -461.1199, y: 999.0, z: -2666.57 },{ x: -462.2597, y: 1000.0, z: -3550.324 },{ x: -462.0262, y: 1000.0, z: -3838.086 },{ x: -461.8658, y: 1000.0, z: -3985.592 },{ x: -454.496, y: 1002.36, z: -4075.825 },{ x: -427.6825, y: 1004.891, z: -4173.264 },{ x: -373.038, y: 1008.738, z: -4271.619 },{ x: -277.1182, y: 1012.872, z: -4367.884 },{ x: -158.158, y: 1014.701, z: -4433.97 },{ x: -10.95229, y: 1016.534, z: -4461.357 },{ x: 124.3943, y: 1015.101, z: -4445.037 },{ x: 247.9735, y: 1013.839, z: -4388.42 },{ x: 361.431, y: 1010.31, z: -4287.911 },{ x: 428.5908, y: 1005.905, z: -4169.774 },{ x: 457.7338, y: 1002.354, z: -4047.419 },{ x: 462.1473, y: 1000.0, z: -3995.304 },{ x: 461.8489, y: 1000.0, z: -3835.417 },{ x: 461.8489, y: 1000.0, z: -3553.59 },{ x: 461.849, y: 999.0, z: -2572.754 },{ x: 461.8489, y: 999.0, z: -2101.76 },{ x: 461.8488, y: 999.0, z: -1603.964 },{ x: 461.8488, y: 999.0001, z: -1159.377 },{ x: 462.0199, y: 999.0, z: -707.3065 },{ x: 461.8488, y: 999.0, z: -236.5238 },{ x: 461.8489, y: 999.0, z: 188.4112 },{ x: 461.2613, y: 999.0, z: 558.6042 },{ x: 462.2144, y: 999.0, z: 1000.509 },{ x: 461.8489, y: 999.0, z: 1396.142 },{ x: 462.0277, y: 999.0, z: 1804.13 },{ x: 461.8488, y: 999.0, z: 2229.66 },{ x: 461.6623, y: 999.0, z: 2716.506 },{ x: 462.0276, y: 999.9999, z: 3497.223 },{ x: 461.7769, y: 1000.0, z: 3841.587 },{ x: 461.808, y: 1000.0, z: 3989.507 },{ x: 456.1951, y: 1002.363, z: 4060.296 },{ x: 430.3923, y: 1004.6, z: 4165.936 },{ x: 361.5549, y: 1009.022, z: 4287.281 },{ x: 261.1601, y: 1013.486, z: 4380.44 },{ x: 137.8372, y: 1015.026, z: 4441.094 },{ x: 0.5095406, y: 1016.463, z: 4461.277 },{ x: -132.9041, y: 1015.207, z: 4443.265 },{ x: -256.1136, y: 1013.523, z: 4382.648 },{ x: -348.6774, y: 1009.907, z: 4303.568 },{ x: -429.6727, y: 1004.712, z: 4168.627 },{ x: -451.9733, y: 1002.427, z: 4082.163 },{ x: -462.2607, y: 1000.0, z: 3990.297 },{ x: -461.8624, y: 1000.0, z: 3863.967 },{ x: -461.1202, y: 1000.0, z: 3520.335 },{ x: -461.1202, y: 1000.0, z: 2795.903 },{ x: -462.0967, y: 1000.0, z: 2378.998 }];
const RACEWAY_PT = [{ x: 1802.788, y: 593.9826, z: 1125.743 },{ x: 1810.97, y: 593.1548, z: 1005.34 },{ x: 1815.492, y: 592.0987, z: 885.7959 },{ x: 1821.461, y: 592.0911, z: 580.7825 },{ x: 1822.656, y: 591.9933, z: 198.4994 },{ x: 1822.476, y: 590.9787, z: -316.7368 },{ x: 1823.429, y: 588.2018, z: -596.1219 },{ x: 1823.94, y: 585.3397, z: -798.3835 },{ x: 1823.24, y: 582.432, z: -970.0403 },{ x: 1806.266, y: 579.6555, z: -1173.879 },{ x: 1793.849, y: 580.239, z: -1290.318 },{ x: 1742.238, y: 583.8242, z: -1419.444 },{ x: 1649.079, y: 588.7001, z: -1514.459 },{ x: 1548.695, y: 593.9182, z: -1586.44 },{ x: 1458.318, y: 600.0355, z: -1661.547 },{ x: 1325.998, y: 607.4919, z: -1749.178 },{ x: 1181.569, y: 615.514, z: -1841.68 },{ x: 1047.648, y: 621.1362, z: -1909.488 },{ x: 933.3569, y: 627.1091, z: -1960.109 },{ x: 815.2159, y: 633.2141, z: -1977.007 },{ x: 714.4042, y: 637.9379, z: -1962.966 },{ x: 616.0771, y: 641.1002, z: -1922.789 },{ x: 518.2226, y: 642.2095, z: -1849.733 },{ x: 435.3945, y: 639.3224, z: -1738.71 },{ x: 394.0432, y: 633.5471, z: -1624.494 },{ x: 382.7271, y: 626.4434, z: -1501.206 },{ x: 435.8581, y: 613.5601, z: -1336.608 },{ x: 496.0001, y: 601.4973, z: -1196.472 },{ x: 533.734, y: 595.1856, z: -1097.467 },{ x: 585.6521, y: 589.1332, z: -985.1511 },{ x: 607.9166, y: 584.7626, z: -880.8633 },{ x: 592.6309, y: 580.5341, z: -769.692 },{ x: 526.2579, y: 576.3462, z: -656.483 },{ x: 416.7543, y: 573.0955, z: -590.1617 },{ x: 305.1117, y: 571.0764, z: -577.1862 },{ x: 193.0751, y: 569.5166, z: -592.3177 },{ x: 85.83138, y: 568.1684, z: -664.7253 },{ x: -10.14996, y: 568.2958, z: -749.4287 },{ x: -152.5317, y: 570.2825, z: -941.0126 },{ x: -268.7789, y: 569.8165, z: -1129.684 },{ x: -330.6462, y: 571.0831, z: -1258.141 },{ x: -370.718, y: 573.8295, z: -1355.474 },{ x: -391.9263, y: 577.4061, z: -1475.941 },{ x: -382.6638, y: 581.1453, z: -1607.146 },{ x: -319.6666, y: 585.321, z: -1770.324 },{ x: -217.5738, y: 588.5681, z: -1903.121 },{ x: -102.8718, y: 594.0481, z: -2021.376 },{ x: 64.75294, y: 598.3005, z: -2148.292 },{ x: 242.6404, y: 601.377, z: -2272.034 },{ x: 422.6038, y: 602.681, z: -2385.65 },{ x: 566.1457, y: 602.3243, z: -2453.201 },{ x: 712.9355, y: 603.3124, z: -2513.546 },{ x: 862.9255, y: 601.3091, z: -2545.091 },{ x: 1027.478, y: 594.6833, z: -2542.977 },{ x: 1187.11, y: 586.3624, z: -2498.272 },{ x: 1307.688, y: 579.8971, z: -2436.869 },{ x: 1429.962, y: 573.9141, z: -2349.926 },{ x: 1533.358, y: 570.14, z: -2283.842 },{ x: 1654.596, y: 567.2324, z: -2207.576 },{ x: 1763.717, y: 565.8087, z: -2135.377 },{ x: 1890.18, y: 564.2639, z: -2087.486 },{ x: 2027.501, y: 558.9393, z: -2091.805 },{ x: 2215.916, y: 549.1902, z: -2142.359 },{ x: 2453.653, y: 541.9773, z: -2248.466 },{ x: 2731.575, y: 534.0495, z: -2373.669 },{ x: 2911.976, y: 528.7871, z: -2429.265 },{ x: 3073.9, y: 526.5457, z: -2472.256 },{ x: 3238.934, y: 525.7438, z: -2481.876 },{ x: 3397.318, y: 525.0707, z: -2436.981 },{ x: 3526.331, y: 523.512, z: -2321.282 },{ x: 3595.171, y: 521.9148, z: -2182.693 },{ x: 3606.892, y: 521.1332, z: -2020.708 },{ x: 3562.008, y: 522.59, z: -1881.425 },{ x: 3406.495, y: 531.9841, z: -1726.352 },{ x: 3217.521, y: 550.3663, z: -1604.453 },{ x: 2979.99, y: 575.8448, z: -1488.299 },{ x: 2740.392, y: 605.7665, z: -1375.61 },{ x: 2533.559, y: 633.5271, z: -1279.241 },{ x: 2307.769, y: 665.1829, z: -1174.415 },{ x: 2108.411, y: 693.7305, z: -1082.323 },{ x: 1904.741, y: 723.5637, z: -987.8712 },{ x: 1725.28, y: 750.1037, z: -904.4977 },{ x: 1488.849, y: 786.0197, z: -793.916 },{ x: 1248.861, y: 918.9442, z: -682.5974 },{ x: 1167.005, y: 851.8283, z: -644.4188 },{ x: 1006.214, y: 870.4809, z: -571.1036 },{ x: 758.9727, y: 879.1896, z: -456.606 },{ x: 465.7757, y: 862.1303, z: -320.3971 },{ x: 184.4453, y: 818.8271, z: -189.7332 },{ x: -54.38692, y: 790.1133, z: -78.80865 },{ x: -366.7062, y: 751.0787, z: 55.87189 },{ x: -618.8309, y: 592.2203, z: 174.2528 },{ x: -824.6157, y: 593.4682, z: 269.7541 },{ x: -1006.012, y: 594.0041, z: 353.0737 },{ x: -1123.059, y: 594.2504, z: 393.7002 },{ x: -1254.741, y: 593.5786, z: 456.3188 },{ x: -1439.674, y: 590.4186, z: 578.3037 },{ x: -1542.099, y: 592.5728, z: 658.4297 },{ x: -1606.104, y: 596.1495, z: 765.8668 },{ x: -1623.543, y: 595.6027, z: 904.4847 },{ x: -1584.761, y: 592.1537, z: 1043.156 },{ x: -1487.852, y: 590.4382, z: 1159.047 },{ x: -1344.006, y: 593.5013, z: 1258.198 },{ x: -1180.478, y: 597.6581, z: 1337.664 },{ x: -1040.714, y: 601.9358, z: 1407.526 },{ x: -887.2369, y: 610.3015, z: 1507.391 },{ x: -759.4128, y: 623.5128, z: 1622.098 },{ x: -667.3811, y: 643.353, z: 1792.455 },{ x: -592.5773, y: 660.1375, z: 1925.517 },{ x: -476.3159, y: 678.9557, z: 2043.2 },{ x: -336.1613, y: 684.2981, z: 2084.925 },{ x: -157.5494, y: 672.4882, z: 2054.132 },{ x: -15.34382, y: 654.8317, z: 1977.806 },{ x: 171.141, y: 627.6316, z: 1805.23 },{ x: 317.3268, y: 611.9873, z: 1689.081 },{ x: 450.2375, y: 604.898, z: 1615.758 },{ x: 583.3854, y: 598.3091, z: 1620.6 },{ x: 732.9598, y: 592.1276, z: 1654.997 },{ x: 959.0031, y: 584.0478, z: 1732.399 },{ x: 1117.76, y: 584.3437, z: 1761.589 },{ x: 1261.313, y: 589.0226, z: 1780.106 },{ x: 1419.146, y: 597.8727, z: 1763.937 },{ x: 1554.159, y: 604.4431, z: 1710.97 },{ x: 1666.985, y: 604.7546, z: 1607.832 },{ x: 1726.749, y: 600.5594, z: 1485.307 },{ x: 1766.604, y: 596.4701, z: 1321.342 }];

const RIVERSIDE = { loop: true, points: RIVERSIDE_PT };
const EXCITEBIKE = { loop: true, points: EXCITEBIKE_PT };
const RACEWAY = { loop: true, points: RACEWAY_PT };